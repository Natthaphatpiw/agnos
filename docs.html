<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Symptom Recommendation API - Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --background: #ffffff;
            --surface: #f8fafc;
            --border: #e2e8f0;
            --text: #1e293b;
            --text-secondary: #64748b;
            --code-bg: #1e293b;
            --code-text: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --sidebar-width: 280px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--surface);
            border-right: 1px solid var(--border);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            padding: 2rem 0;
        }

        .logo {
            padding: 0 1.5rem;
            margin-bottom: 2rem;
        }

        .logo h1 {
            font-size: 1.25rem;
            color: var(--primary-color);
            font-weight: 700;
        }

        .logo p {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .nav-section {
            margin-bottom: 1.5rem;
        }

        .nav-section-title {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            padding: 0 1.5rem;
            margin-bottom: 0.5rem;
            letter-spacing: 0.05em;
        }

        .nav-item {
            display: block;
            padding: 0.5rem 1.5rem;
            color: var(--text);
            text-decoration: none;
            font-size: 0.875rem;
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: rgba(37, 99, 235, 0.05);
            color: var(--primary-color);
        }

        .nav-item.active {
            background: rgba(37, 99, 235, 0.05);
            color: var(--primary-color);
            border-left-color: var(--primary-color);
            font-weight: 500;
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            flex: 1;
            padding: 3rem;
            max-width: 1200px;
        }

        .hero {
            margin-bottom: 3rem;
        }

        .hero h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 1.125rem;
            color: var(--text-secondary);
            max-width: 700px;
        }

        .section {
            margin-bottom: 4rem;
            scroll-margin-top: 2rem;
        }

        .section h2 {
            font-size: 1.875rem;
            font-weight: 700;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .section h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 2rem 0 1rem;
            color: var(--primary-color);
        }

        .section h4 {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 1.5rem 0 1rem;
        }

        .section p {
            margin-bottom: 1rem;
            color: var(--text-secondary);
            line-height: 1.8;
        }

        /* Cards */
        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .card-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Code Blocks */
        .code-block {
            background: var(--code-bg);
            color: var(--code-text);
            padding: 1.5rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            position: relative;
        }

        .code-block pre {
            margin: 0;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .code-lang {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            font-weight: 600;
        }

        .copy-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--code-text);
            padding: 0.25rem 0.75rem;
            border-radius: 0.25rem;
            cursor: pointer;
            font-size: 0.75rem;
            transition: background 0.2s;
        }

        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Inline Code */
        code {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary-color);
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875em;
        }

        .code-block code {
            background: transparent;
            color: inherit;
            padding: 0;
        }

        /* Architecture Diagram */
        .diagram {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 0.5rem;
            padding: 2rem;
            margin: 2rem 0;
            text-align: center;
            font-family: monospace;
            line-height: 2;
        }

        .diagram-box {
            background: white;
            border: 2px solid var(--primary-color);
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem auto;
            display: inline-block;
            min-width: 200px;
        }

        .diagram-arrow {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin: 0.5rem 0;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            border-radius: 0.5rem;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        th {
            background: var(--surface);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--text);
            border-bottom: 2px solid var(--border);
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            font-size: 0.875rem;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background: var(--surface);
        }

        /* API Reference */
        .endpoint {
            background: white;
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            margin: 2rem 0;
            overflow: hidden;
        }

        .endpoint-header {
            background: var(--surface);
            padding: 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .endpoint-method {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 0.25rem;
            font-weight: 600;
            font-size: 0.75rem;
            margin-right: 0.75rem;
        }

        .method-post { background: #10b981; color: white; }
        .method-get { background: #3b82f6; color: white; }

        .endpoint-path {
            font-family: monospace;
            font-size: 1rem;
            color: var(--text);
        }

        .endpoint-body {
            padding: 1.5rem;
        }

        .param-list {
            list-style: none;
            margin: 1rem 0;
        }

        .param-item {
            padding: 1rem;
            background: var(--surface);
            border-radius: 0.25rem;
            margin-bottom: 0.75rem;
        }

        .param-name {
            font-family: monospace;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }

        .param-type {
            display: inline-block;
            font-size: 0.75rem;
            color: var(--text-secondary);
            background: rgba(37, 99, 235, 0.1);
            padding: 0.125rem 0.5rem;
            border-radius: 0.25rem;
            margin-left: 0.5rem;
        }

        .param-required {
            color: var(--error);
            font-size: 0.75rem;
            margin-left: 0.5rem;
        }

        .param-desc {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 0.5rem;
            border-bottom: 2px solid var(--border);
            margin-bottom: 1rem;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            transition: all 0.2s;
        }

        .tab:hover {
            color: var(--primary-color);
        }

        .tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
            margin: 0.25rem;
        }

        .badge-success { background: rgba(16, 185, 129, 0.1); color: var(--success); }
        .badge-warning { background: rgba(245, 158, 11, 0.1); color: var(--warning); }
        .badge-error { background: rgba(239, 68, 68, 0.1); color: var(--error); }
        .badge-info { background: rgba(37, 99, 235, 0.1); color: var(--primary-color); }

        /* Highlights */
        .highlight {
            background: rgba(37, 99, 235, 0.05);
            border-left: 4px solid var(--primary-color);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0.25rem;
        }

        .highlight-title {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                padding: 1.5rem;
            }

            .hero h1 {
                font-size: 2rem;
            }
        }

        @media print {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                max-width: 100%;
            }

            .code-block {
                page-break-inside: avoid;
            }
        }

        /* Syntax Highlighting Colors */
        .keyword { color: #c678dd; }
        .string { color: #98c379; }
        .number { color: #d19a66; }
        .comment { color: #5c6370; font-style: italic; }
        .function { color: #61afef; }
        .operator { color: #56b6c2; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="logo">
                <h1>🏥 Symptom API</h1>
                <p>เอกสารฉบับสมบูรณ์</p>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">เริ่มต้น</div>
                <a href="#introduction" class="nav-item active">Introduction</a>
                <a href="#quick-start" class="nav-item">Quick Start</a>
                <a href="#architecture" class="nav-item">Architecture</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">สถาปัตยกรรม ML</div>
                <a href="#ml-overview" class="nav-item">ภาพรวม</a>
                <a href="#collaborative-filtering" class="nav-item">Collaborative Filtering</a>
                <a href="#content-based" class="nav-item">Content-Based</a>
                <a href="#graph-neural-network" class="nav-item">Graph Neural Network</a>
                <a href="#fusion" class="nav-item">Fusion Strategy</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Training</div>
                <a href="#data-preprocessing" class="nav-item">Data Preprocessing</a>
                <a href="#training-loop" class="nav-item">Training Loop</a>
                <a href="#evaluation" class="nav-item">Evaluation Metrics</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">API Reference</div>
                <a href="#api-recommend" class="nav-item">POST /recommend</a>
                <a href="#api-health" class="nav-item">GET /health</a>
                <a href="#api-symptoms" class="nav-item">GET /symptoms</a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">ตัวอย่าง</div>
                <a href="#examples" class="nav-item">Use Cases</a>
                <a href="#error-handling" class="nav-item">Error Handling</a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Hero Section -->
            <div class="hero">
                <h1>🏥 Symptom Recommendation API</h1>
                <p>
                    ระบบแนะนำอาการทางการแพทย์แบบอัจฉริยะด้วย Deep Learning
                    รวมเทคนิค Collaborative Filtering, Content-Based และ Graph Neural Networks
                    เพื่อการแนะนำที่แม่นยำและเชื่อถือได้
                </p>
            </div>

            <!-- Introduction -->
            <section id="introduction" class="section">
                <h2>📚 Introduction</h2>
                <p>
                    Symptom Recommendation API เป็นระบบที่ช่วย<strong>แนะนำอาการทางการแพทย์ที่เป็นไปได้ต่อไป</strong>
                    โดยอิงจากข้อมูลผู้ป่วยในอดีต คล้ายกับที่ Netflix แนะนำหนังจากประวัติการดู
                    แต่เราแนะนำอาการจากข้อมูลอาการเริ่มต้นและข้อมูลส่วนตัว
                </p>

                <div class="card">
                    <div class="card-title">✨ คุณสมบัติหลัก</div>
                    <ul>
                        <li><strong>Hybrid ML Model</strong>: รวม 3 เทคนิคเข้าด้วยกัน (CF + CB + Graph)</li>
                        <li><strong>รองรับภาษาไทย</strong>: จัดการอาการภาษาไทยได้อย่างสมบูรณ์</li>
                        <li><strong>Fast Inference</strong>: ตอบสนองภายใน 20-50ms</li>
                        <li><strong>Production-Ready</strong>: FastAPI พร้อม error handling ครบถ้วน</li>
                        <li><strong>Scalable</strong>: รองรับผู้ใช้หลายคนพร้อมกัน</li>
                    </ul>
                </div>

                <div class="highlight">
                    <div class="highlight-title">💡 Use Case ตัวอย่าง</div>
                    ผู้ป่วยชายอายุ 26 ปี มีอาการ "ไอ" → ระบบแนะนำ: "เสมหะ", "เจ็บคอ", "น้ำมูกไหล", "ไข้", "ปวดศีรษะ"
                </div>
            </section>

            <!-- Quick Start -->
            <section id="quick-start" class="section">
                <h2>🚀 Quick Start</h2>

                <h3>Installation</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre><code><span class="comment"># Clone repository</span>
git clone https://github.com/yourname/symptom-api.git
cd symptom-api

<span class="comment"># Install dependencies</span>
pip install -r requirements.txt

<span class="comment"># Train model</span>
python train.py

<span class="comment"># Start API server</span>
python -m uvicorn app:app --reload</code></pre>
                </div>

                <h3>First API Call</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">bash</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                    </div>
                    <pre><code>curl -X POST http://localhost:8000/recommend \
  -H <span class="string">"Content-Type: application/json"</span> \
  -d <span class="string">'{
    "gender": "male",
    "age": 26,
    "symptoms": ["ไอ"],
    "top_k": 5
  }'</span></code></pre>
                </div>

                <div class="card">
                    <div class="card-title">📦 Response</div>
                    <div class="code-block">
                        <pre><code>{
  <span class="string">"recommendations"</span>: [<span class="string">"เสมหะ"</span>, <span class="string">"เจ็บคอ"</span>, <span class="string">"น้ำมูกไหล"</span>, <span class="string">"ไข้"</span>, <span class="string">"ปวดศีรษะ"</span>],
  <span class="string">"query_symptoms"</span>: [<span class="string">"ไอ"</span>],
  <span class="string">"unknown_symptoms"</span>: []
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Architecture Overview -->
            <section id="architecture" class="section">
                <h2>🏗️ Architecture Overview</h2>
                <p>
                    ระบบประกอบด้วย 2 ส่วนหลัก: <strong>ML Model</strong> สำหรับการแนะนำ
                    และ <strong>FastAPI Backend</strong> สำหรับ serve API
                </p>

                <div class="diagram">
                    <div class="diagram-box">
                        <strong>Input</strong><br>
                        Gender, Age, Symptoms
                    </div>
                    <div class="diagram-arrow">↓</div>
                    <div style="display: flex; gap: 1rem; justify-content: center;">
                        <div class="diagram-box">
                            <strong>CF</strong><br>
                            NCF Model
                        </div>
                        <div class="diagram-box">
                            <strong>CB</strong><br>
                            Cosine Sim
                        </div>
                        <div class="diagram-box">
                            <strong>Graph</strong><br>
                            GAT
                        </div>
                    </div>
                    <div class="diagram-arrow">↓</div>
                    <div class="diagram-box">
                        <strong>Fusion</strong><br>
                        Weighted Sum (0.4 + 0.4 + 0.2)
                    </div>
                    <div class="diagram-arrow">↓</div>
                    <div class="diagram-box">
                        <strong>Output</strong><br>
                        Top-K Recommendations
                    </div>
                </div>
            </section>

            <!-- ML Architecture -->
            <section id="ml-overview" class="section">
                <h2>🧠 สถาปัตยกรรม Machine Learning</h2>
                <p>
                    โมเดลของเราใช้แนวทาง <strong>Hybrid Architecture</strong>
                    ที่รวมจุดแข็งของ 3 เทคนิคเข้าด้วยกัน ทำให้ได้ผลลัพธ์ที่แม่นยำและครอบคลุม
                </p>

                <table>
                    <thead>
                        <tr>
                            <th>เทคนิค</th>
                            <th>หลักการ</th>
                            <th>จุดแข็ง</th>
                            <th>Weight</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-info">CF (NCF)</span></td>
                            <td>เรียนรู้จากพฤติกรรมผู้ป่วยที่คล้ายกัน</td>
                            <td>จับ pattern ซับซ้อนได้ดี</td>
                            <td><strong>40%</strong></td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-success">CB (Cosine)</span></td>
                            <td>เปรียบเทียบความคล้ายของอาการ</td>
                            <td>ทำงานกับผู้ป่วยใหม่ได้</td>
                            <td><strong>40%</strong></td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-warning">Graph (GAT)</span></td>
                            <td>เรียนรู้จาก co-occurrence graph</td>
                            <td>จับความสัมพันธ์ระหว่างอาการ</td>
                            <td><strong>20%</strong></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Collaborative Filtering -->
            <section id="collaborative-filtering" class="section">
                <h2>1️⃣ Collaborative Filtering (CF) - NCF</h2>

                <h3>💡 หลักการแบบเข้าใจง่าย</h3>
                <p>
                    ลองคิดถึงการแนะนำหนังใน Netflix: ถ้าคุณและเพื่อนชอบหนังเหมือนกัน 5 เรื่อง
                    และเพื่อนชอบหนังอีก 1 เรื่องที่คุณยังไม่ดู Netflix ก็จะแนะนำหนังนั้นให้คุณ
                </p>
                <p>
                    <strong>CF ทำงานแบบเดียวกัน:</strong> ถ้าผู้ป่วย A และ B มีอาการเริ่มต้นเหมือนกัน
                    และผู้ป่วย B มีอาการเพิ่มเติม → ระบบจะแนะนำอาการเพิ่มเติมนั้นให้ผู้ป่วย A
                </p>

                <div class="highlight">
                    <div class="highlight-title">📖 ตัวอย่างจริง</div>
                    <strong>ผู้ป่วย A:</strong> ไอ, เสมหะ → ?<br>
                    <strong>ผู้ป่วย B:</strong> ไอ, เสมหะ → เจ็บคอ, ไข้<br>
                    <strong>ระบบแนะนำ:</strong> เจ็บคอ, ไข้ (เพราะผู้ป่วย B มีอาการคล้ายกัน)
                </div>

                <h3>🔧 เทคนิคที่ใช้: Neural Collaborative Filtering (NCF)</h3>
                <p>
                    เราใช้ NCF ซึ่งเป็นเวอร์ชันที่ดีขึ้นของ CF แบบดั้งเดิม โดยใช้ Neural Networks
                    เพื่อเรียนรู้ความสัมพันธ์ที่ซับซ้อนระหว่างผู้ป่วยกับอาการ
                </p>

                <h4>NCF = GMF + MLP</h4>

                <div class="card">
                    <div class="card-title">🔹 GMF (Generalized Matrix Factorization)</div>
                    <p>คูณ embeddings ของผู้ป่วยกับอาการแบบ element-wise (เหมือนการหา "ความเข้ากันได้")</p>
                    <div class="code-block">
                        <pre><code><span class="comment"># Embedding ของผู้ป่วย (128 มิติ)</span>
patient_embed = [<span class="number">0.23</span>, -<span class="number">0.45</span>, <span class="number">0.12</span>, ...]

<span class="comment"># Embedding ของอาการ (128 มิติ)</span>
symptom_embed = [<span class="number">0.25</span>, -<span class="number">0.40</span>, <span class="number">0.15</span>, ...]

<span class="comment"># คูณทีละตำแหน่ง</span>
gmf_vector = patient_embed * symptom_embed
           = [<span class="number">0.0575</span>, <span class="number">0.180</span>, <span class="number">0.018</span>, ...]

<span class="comment"># ผ่าน Linear layer → คะแนน</span>
gmf_score = Linear(gmf_vector) = <span class="number">0.82</span></code></pre>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">🔹 MLP (Multi-Layer Perceptron)</div>
                    <p>ต่อ embeddings เข้าด้วยกัน แล้วผ่าน neural network หลายชั้น (เรียนรู้ความสัมพันธ์ที่ซับซ้อน)</p>
                    <div class="code-block">
                        <pre><code><span class="comment"># รวม embeddings + demographics</span>
mlp_input = [patient_embed, symptom_embed, demographics]
          = <span class="number">272</span> dimensions

<span class="comment"># ผ่าน 4 layers</span>
Layer <span class="number">1</span>: <span class="number">272</span> → <span class="number">256</span> (ReLU, BatchNorm, Dropout)
Layer <span class="number">2</span>: <span class="number">256</span> → <span class="number">128</span> (ReLU, BatchNorm, Dropout)
Layer <span class="number">3</span>: <span class="number">128</span> → <span class="number">64</span>  (ReLU, BatchNorm, Dropout)
Layer <span class="number">4</span>: <span class="number">64</span>  → <span class="number">32</span>  (ReLU, BatchNorm, Dropout)
Output:  <span class="number">32</span>  → <span class="number">1</span>   (Final score)

mlp_score = <span class="number">0.78</span></code></pre>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">🔹 รวมคะแนน</div>
                    <div class="code-block">
                        <pre><code>cf_score = gmf_score + mlp_score
         = <span class="number">0.82</span> + <span class="number">0.78</span>
         = <span class="number">1.60</span> → ผ่าน Sigmoid → <span class="number">0.83</span> (คะแนนสุดท้าย)</code></pre>
                    </div>
                </div>

                <h3>🎯 ทำไมถึงใช้ NCF?</h3>
                <ul>
                    <li><strong>GMF</strong>: จับความสัมพันธ์แบบ linear (เร็ว, stable)</li>
                    <li><strong>MLP</strong>: จับความสัมพันธ์แบบ non-linear (ซับซ้อน, แม่นยำ)</li>
                    <li><strong>รวมกัน</strong>: ได้ทั้งความเร็วและความแม่นยำ</li>
                </ul>
            </section>

            <!-- Content-Based Filtering -->
            <section id="content-based" class="section">
                <h2>2️⃣ Content-Based Filtering (CB)</h2>

                <h3>💡 หลักการแบบเข้าใจง่าย</h3>
                <p>
                    เปรียบเหมือนการหาเพลงที่เพราะคล้ายกัน: ถ้าคุณชอบเพลงป๊อป จังหวะเร้าๆ
                    ระบบจะแนะนำเพลงอื่นที่มีลักษณะคล้ายกัน (ไม่สนว่าคนอื่นฟังอะไร)
                </p>
                <p>
                    <strong>CB ทำงานแบบเดียวกัน:</strong> ถ้าผู้ป่วยมีอาการ "ไอ"
                    ระบบจะหาอาการอื่นที่ "คล้าย" กับไอ เช่น "เสมหะ", "เจ็บคอ"
                    (เพราะทั้งหมดเป็นอาการระบบทางเดินหายใจ)
                </p>

                <div class="highlight">
                    <div class="highlight-title">📖 ตัวอย่างจริง</div>
                    <strong>Query:</strong> "ไอ" → มี embedding ที่แทนความหมายของอาการนี้<br>
                    <strong>Candidates:</strong><br>
                    - "เสมหะ" → embedding คล้าย "ไอ" มาก (90%)<br>
                    - "ปวดท้อง" → embedding ไม่คล้าย "ไอ" (15%)<br>
                    <strong>ระบบแนะนำ:</strong> "เสมหะ" (เพราะคล้ายกัน)
                </div>

                <h3>🔧 เทคนิคที่ใช้: Cosine Similarity</h3>
                <p>
                    เราใช้ <strong>Cosine Similarity</strong> เพื่อวัดความคล้าย
                    โดยคิดจาก "มุม" ระหว่าง vector embeddings
                </p>

                <h4>ขั้นตอนการทำงาน</h4>

                <div class="card">
                    <div class="card-title">Step 1: Embed อาการ</div>
                    <div class="code-block">
                        <pre><code><span class="comment"># แต่ละอาการมี embedding 128 มิติ</span>
embed(<span class="string">"ไอ"</span>)     = [<span class="number">0.23</span>, -<span class="number">0.45</span>, <span class="number">0.12</span>, ..., <span class="number">0.89</span>]
embed(<span class="string">"เสมหะ"</span>)  = [<span class="number">0.25</span>, -<span class="number">0.40</span>, <span class="number">0.15</span>, ..., <span class="number">0.85</span>]
embed(<span class="string">"ปวดท้อง"</span>) = [-<span class="number">0.10</span>, <span class="number">0.30</span>, -<span class="number">0.25</span>, ..., -<span class="number">0.12</span>]</code></pre>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Step 2: คำนวณ Cosine Similarity</div>
                    <p>สูตร: <code>cos(θ) = (A · B) / (||A|| × ||B||)</code></p>
                    <div class="code-block">
                        <pre><code><span class="comment"># Normalize vectors (ทำให้ length = 1)</span>
query_norm = normalize(embed(<span class="string">"ไอ"</span>))
candidate_norm = normalize(embed(<span class="string">"เสมหะ"</span>))

<span class="comment"># Cosine similarity (dot product หลัง normalize)</span>
similarity = query_norm · candidate_norm
           = <span class="number">0.23</span>×<span class="number">0.25</span> + (-<span class="number">0.45</span>)×(-<span class="number">0.40</span>) + ... + <span class="number">0.89</span>×<span class="number">0.85</span>
           = <span class="number">0.92</span>  <span class="comment">← คล้ายมาก!</span>

<span class="comment"># กับ "ปวดท้อง"</span>
similarity = normalize(embed(<span class="string">"ไอ"</span>)) · normalize(embed(<span class="string">"ปวดท้อง"</span>))
           = <span class="number">0.15</span>  <span class="comment">← ไม่ค่อยคล้าย</span></code></pre>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Step 3: Rank ตามคะแนน</div>
                    <table>
                        <thead>
                            <tr>
                                <th>อาการ</th>
                                <th>Cosine Similarity</th>
                                <th>Normalized (0-1)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>เสมหะ</td>
                                <td>0.92</td>
                                <td><strong>0.96</strong> ⭐</td>
                            </tr>
                            <tr>
                                <td>เจ็บคอ</td>
                                <td>0.78</td>
                                <td><strong>0.89</strong></td>
                            </tr>
                            <tr>
                                <td>น้ำมูกไหล</td>
                                <td>0.75</td>
                                <td><strong>0.875</strong></td>
                            </tr>
                            <tr>
                                <td>ปวดท้อง</td>
                                <td>0.15</td>
                                <td><strong>0.575</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>🎯 ข้อดีของ Content-Based</h3>
                <ul>
                    <li>✅ <strong>Cold Start</strong>: ทำงานได้กับผู้ป่วยใหม่ที่ไม่มีประวัติ</li>
                    <li>✅ <strong>Explainable</strong>: เห็นได้ชัดว่าแนะนำเพราะคล้ายกัน</li>
                    <li>✅ <strong>Fast</strong>: คำนวณง่าย เพียงแค่ dot product</li>
                    <li>✅ <strong>Diverse</strong>: หาอาการที่หลากหลายได้ (ไม่จำกัดแค่ popular)</li>
                </ul>
            </section>

            <!-- Graph Neural Network -->
            <section id="graph-neural-network" class="section">
                <h2>3️⃣ Graph Neural Network (GAN - GAT)</h2>

                <h3>💡 หลักการแบบเข้าใจง่าย</h3>
                <p>
                    คิดถึง <strong>Social Network</strong>: คุณกับเพื่อนติดต่อกันบ่อย → มีความสัมพันธ์แน่น
                    เพื่อนของเพื่อนก็น่าจะเป็นเพื่อนคุณได้ (friend of friend)
                </p>
                <p>
                    <strong>Graph ทำงานแบบเดียวกัน:</strong> อาการที่เกิดร่วมกันบ่อย (co-occurrence)
                    จะมี "connection" ที่แน่น เช่น "ไอ" มักมากับ "เสมหะ" → มี edge เชื่อมกัน
                </p>

                <div class="highlight">
                    <div class="highlight-title">📖 ตัวอย่าง Graph</div>
                    <pre style="background: white; color: var(--text); padding: 1rem; border-radius: 0.5rem;">
    [ไอ] ━━━━━━ (156 ครั้ง) ━━━━━━ [เสมหะ]
      ┃
      ┃ (203 ครั้ง)
      ┃
    [เจ็บคอ] ━━ (89 ครั้ง) ━━ [น้ำมูกไหล]

    <strong>อ่านว่า:</strong> "ไอ" กับ "เสมหะ" เกิดร่วมกัน 156 ครั้ง
    </pre>
                </div>

                <h3>🔧 เทคนิคที่ใช้: GAT (Graph Attention Network)</h3>
                <p>
                    GAT เป็น Graph Neural Network ที่ใช้ <strong>Attention Mechanism</strong>
                    เพื่อเรียนรู้ว่า neighbor ไหนสำคัญกว่ากัน
                </p>

                <h4>ขั้นตอนการทำงาน</h4>

                <div class="card">
                    <div class="card-title">Step 1: สร้าง Graph</div>
                    <div class="code-block">
                        <pre><code><span class="comment"># Nodes = อาการทั้งหมด (338 อาการ)</span>
nodes = [<span class="string">"ไอ"</span>, <span class="string">"เสมหะ"</span>, <span class="string">"เจ็บคอ"</span>, ..., <span class="string">"ปวดหัว"</span>]

<span class="comment"># Edges = co-occurrence (เกิดร่วมกันในผู้ป่วยคนเดียวกัน)</span>
edges = [
    (<span class="string">"ไอ"</span>, <span class="string">"เสมหะ"</span>, weight=<span class="number">156</span>),
    (<span class="string">"ไอ"</span>, <span class="string">"เจ็บคอ"</span>, weight=<span class="number">203</span>),
    (<span class="string">"เสมหะ"</span>, <span class="string">"น้ำมูกไหล"</span>, weight=<span class="number">89</span>),
    ...
]</code></pre>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Step 2: GAT Layer 1 (Multi-head Attention, 4 heads)</div>
                    <p>สำหรับแต่ละ node จะดู neighbors และคำนวณ attention weights</p>
                    <div class="code-block">
                        <pre><code><span class="comment"># สำหรับ node "ไอ"</span>
neighbors = [<span class="string">"เสมหะ"</span>, <span class="string">"เจ็บคอ"</span>, <span class="string">"น้ำมูกไหล"</span>]

<span class="comment"># คำนวณ attention score กับแต่ละ neighbor</span>
<span class="keyword">for</span> neighbor <span class="keyword">in</span> neighbors:
    <span class="comment"># Attention coefficient (เรียนรู้ได้จาก training)</span>
    alpha = LeakyReLU(W1 @ embed(<span class="string">"ไอ"</span>) + W2 @ embed(neighbor))

<span class="comment"># Softmax ให้ผลรวม = 1</span>
attention_weights = softmax([alpha_เสมหะ, alpha_เจ็บคอ, alpha_น้ำมูกไหล])
                  = [<span class="number">0.5</span>, <span class="number">0.3</span>, <span class="number">0.2</span>]
                    <span class="comment">↑ "เสมหะ" สำคัญที่สุดกับ "ไอ"</span>

<span class="comment"># Update embedding ของ "ไอ"</span>
new_embed(<span class="string">"ไอ"</span>) = <span class="number">0.5</span> × embed(<span class="string">"เสมหะ"</span>) +
                  <span class="number">0.3</span> × embed(<span class="string">"เจ็บคอ"</span>) +
                  <span class="number">0.2</span> × embed(<span class="string">"น้ำมูกไหล"</span>)</code></pre>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Step 3: GAT Layer 2 (Single-head)</div>
                    <p>ทำซ้ำอีกครั้ง เพื่อให้ข้อมูลแพร่กระจายไปไกลขึ้น (2 hops)</p>
                    <div class="code-block">
                        <pre><code><span class="comment"># Layer 2 ใช้ embedding จาก Layer 1 เป็น input</span>
<span class="comment"># ทำให้ "ไอ" ได้รับข้อมูลจาก friend-of-friend ด้วย</span>

<span class="comment"># ตัวอย่าง:</span>
<span class="string">"ไอ"</span> → <span class="string">"เสมหะ"</span> → <span class="string">"คอแห้ง"</span>  <span class="comment">(2 hops)</span>
ตอนนี้ <span class="string">"ไอ"</span> รู้จัก <span class="string">"คอแห้ง"</span> ทางอ้อมแล้ว!</code></pre>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Step 4: คำนวณ Graph Score</div>
                    <div class="code-block">
                        <pre><code><span class="comment"># ใช้ embedding หลัง GAT คำนวณ similarity</span>
query_gat = gat_embed(<span class="string">"ไอ"</span>)
candidate_gat = gat_embed(<span class="string">"เสมหะ"</span>)

graph_score = cosine_sim(query_gat, candidate_gat)
            = <span class="number">0.88</span>  <span class="comment">← คะแนนจาก graph structure</span></code></pre>
                    </div>
                </div>

                <h3>🎯 ทำไมถึงใช้ GAT?</h3>
                <ul>
                    <li>✅ <strong>Co-occurrence Patterns</strong>: จับอาการที่มักเกิดร่วมกัน</li>
                    <li>✅ <strong>Multi-hop</strong>: เรียนรู้ความสัมพันธ์ทางอ้อม (friend of friend)</li>
                    <li>✅ <strong>Attention</strong>: ให้ความสำคัญกับ neighbor ที่เกี่ยวข้องมากกว่า</li>
                    <li>✅ <strong>Context-aware</strong>: embedding เปลี่ยนไปตาม context รอบข้าง</li>
                </ul>

                <div class="highlight">
                    <div class="highlight-title">💡 ตัวอย่างผลลัพธ์</div>
                    ถ้าผู้ป่วยหลายคนที่มี "ไอ" + "เสมหะ" มักมี "เจ็บคอ" ตามมา<br>
                    → Graph จะเรียนรู้ pattern นี้และแนะนำ "เจ็บคอ" เมื่อเห็น "ไอ" + "เสมหะ"
                </div>
            </section>

            <!-- Fusion Strategy -->
            <section id="fusion" class="section">
                <h2>🔀 Fusion Strategy - การรวมคะแนนทั้ง 3 สาย</h2>

                <h3>💡 ทำไมต้องรวม?</h3>
                <p>
                    แต่ละเทคนิคมีจุดแข็งต่างกัน:
                </p>
                <ul>
                    <li><strong>CF</strong>: เก่งเรื่องเรียนรู้จากพฤติกรรมผู้ป่วย (แต่ cold start ไม่ดี)</li>
                    <li><strong>CB</strong>: เก่งเรื่อง cold start (แต่ไม่รู้พฤติกรรมผู้ป่วย)</li>
                    <li><strong>Graph</strong>: เก่งเรื่อง co-occurrence (แต่อาจจะ overfit)</li>
                </ul>
                <p>
                    <strong>รวมกัน</strong> → ได้ทั้งความแม่นยำและความหลากหลาย!
                </p>

                <h3>🔧 วิธีการรวม: Weighted Sum</h3>

                <div class="card">
                    <div class="card-title">Step 1: Normalize คะแนนทุกสายให้อยู่ใน [0, 1]</div>
                    <div class="code-block">
                        <pre><code><span class="comment"># CF score (ผ่าน Sigmoid)</span>
cf_norm = sigmoid(cf_score)
        = sigmoid(<span class="number">1.60</span>) = <span class="number">0.83</span>

<span class="comment"># CB score (Cosine อยู่ใน [-1, 1] → แปลงเป็น [0, 1])</span>
cb_norm = (cb_score + <span class="number">1</span>) / <span class="number">2</span>
        = (<span class="number">0.92</span> + <span class="number">1</span>) / <span class="number">2</span> = <span class="number">0.96</span>

<span class="comment"># Graph score (Cosine อยู่ใน [-1, 1] → แปลงเป็น [0, 1])</span>
graph_norm = (graph_score + <span class="number">1</span>) / <span class="number">2</span>
           = (<span class="number">0.88</span> + <span class="number">1</span>) / <span class="number">2</span> = <span class="number">0.94</span></code></pre>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Step 2: กำหนด Weights (Learnable Parameters)</div>
                    <div class="code-block">
                        <pre><code><span class="comment"># เริ่มต้นที่ [0.4, 0.4, 0.2]</span>
fusion_weights = nn.Parameter([<span class="number">0.4</span>, <span class="number">0.4</span>, <span class="number">0.2</span>])

<span class="comment"># ผ่าน Softmax เพื่อให้ผลรวม = 1</span>
weights = softmax(fusion_weights)
        = [<span class="number">0.385</span>, <span class="number">0.385</span>, <span class="number">0.230</span>]  <span class="comment">← ตัวอย่างหลัง training</span></code></pre>
                    </div>
                    <p><strong>หมายเหตุ:</strong> น้ำหนักเหล่านี้จะถูกปรับระหว่าง training ให้เหมาะสมที่สุด</p>
                </div>

                <div class="card">
                    <div class="card-title">Step 3: Weighted Sum</div>
                    <div class="code-block">
                        <pre><code>final_score = weights[<span class="number">0</span>] × cf_norm +
              weights[<span class="number">1</span>] × cb_norm +
              weights[<span class="number">2</span>] × graph_norm

            = <span class="number">0.385</span> × <span class="number">0.83</span> + <span class="number">0.385</span> × <span class="number">0.96</span> + <span class="number">0.230</span> × <span class="number">0.94</span>
            = <span class="number">0.319</span> + <span class="number">0.370</span> + <span class="number">0.216</span>
            = <span class="number">0.905</span>  <span class="comment">← คะแนนสุดท้าย</span></code></pre>
                    </div>
                </div>

                <h3>📊 ตัวอย่างการคำนวณจริง</h3>
                <p>สำหรับอาการ "เสมหะ" เมื่อ query = "ไอ"</p>

                <table>
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Raw Score</th>
                            <th>Normalized</th>
                            <th>Weight</th>
                            <th>Contribution</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-info">CF</span></td>
                            <td>1.60</td>
                            <td>0.83</td>
                            <td>40%</td>
                            <td><strong>0.332</strong></td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-success">CB</span></td>
                            <td>0.92</td>
                            <td>0.96</td>
                            <td>40%</td>
                            <td><strong>0.384</strong> ⭐</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-warning">Graph</span></td>
                            <td>0.88</td>
                            <td>0.94</td>
                            <td>20%</td>
                            <td><strong>0.188</strong></td>
                        </tr>
                        <tr style="background: var(--surface); font-weight: 600;">
                            <td colspan="4">Final Score</td>
                            <td><strong>0.904</strong></td>
                        </tr>
                    </tbody>
                </table>

                <div class="highlight">
                    <div class="highlight-title">💡 สังเกต</div>
                    CB มี contribution สูงสุดเพราะ cosine similarity สูง (0.96)<br>
                    Graph ช่วยเสริม (0.94) เพราะ "ไอ" กับ "เสมหะ" เกิดร่วมกันบ่อย<br>
                    CF ให้คะแนนปานกลาง (0.83) จากพฤติกรรมผู้ป่วย
                </div>

                <h3>🎯 ทำไมใช้ weights [0.4, 0.4, 0.2]?</h3>
                <ul>
                    <li><strong>CF (40%)</strong>: สำคัญที่สุด เพราะเรียนรู้จากข้อมูลจริง</li>
                    <li><strong>CB (40%)</strong>: สำคัญพอๆ กัน เพราะช่วย cold start และ diverse</li>
                    <li><strong>Graph (20%)</strong>: เป็น supplement เพื่อเพิ่ม context</li>
                </ul>
                <p>
                    <strong>หมายเหตุ:</strong> น้ำหนักเหล่านี้ถูกปรับอัตโนมัติระหว่าง training
                    ผ่าน gradient descent เพื่อหาค่าที่ดีที่สุด
                </p>
            </section>

            <!-- API Reference -->
            <section id="api-recommend" class="section">
                <h2>📡 API Reference</h2>

                <!-- POST /recommend -->
                <div class="endpoint">
                    <div class="endpoint-header">
                        <div>
                            <span class="endpoint-method method-post">POST</span>
                            <span class="endpoint-path">/recommend</span>
                        </div>
                        <p style="margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">
                            แนะนำอาการทางการแพทย์ที่เป็นไปได้ต่อไป
                        </p>
                    </div>
                    <div class="endpoint-body">
                        <h4>Request Body</h4>
                        <ul class="param-list">
                            <li class="param-item">
                                <div class="param-name">
                                    gender
                                    <span class="param-type">string</span>
                                    <span class="param-required">required</span>
                                </div>
                                <div class="param-desc">
                                    เพศของผู้ป่วย ต้องเป็น <code>"male"</code> หรือ <code>"female"</code>
                                </div>
                            </li>
                            <li class="param-item">
                                <div class="param-name">
                                    age
                                    <span class="param-type">integer</span>
                                    <span class="param-required">required</span>
                                </div>
                                <div class="param-desc">
                                    อายุของผู้ป่วย (0-120 ปี)
                                </div>
                            </li>
                            <li class="param-item">
                                <div class="param-name">
                                    symptoms
                                    <span class="param-type">array[string]</span>
                                    <span class="param-required">required</span>
                                </div>
                                <div class="param-desc">
                                    รายการอาการเริ่มต้น (ภาษาไทยหรืออังกฤษ) ต้องมีอย่างน้อย 1 อาการ
                                </div>
                            </li>
                            <li class="param-item">
                                <div class="param-name">
                                    top_k
                                    <span class="param-type">integer</span>
                                    <span style="color: var(--text-secondary); font-size: 0.75rem;">optional</span>
                                </div>
                                <div class="param-desc">
                                    จำนวนอาการที่ต้องการแนะนำ (1-20) ค่าเริ่มต้น: <code>5</code>
                                </div>
                            </li>
                        </ul>

                        <h4>Response</h4>
                        <ul class="param-list">
                            <li class="param-item">
                                <div class="param-name">
                                    recommendations
                                    <span class="param-type">array[string]</span>
                                </div>
                                <div class="param-desc">
                                    รายการอาการที่แนะนำ เรียงตามความเป็นไปได้สูงสุด
                                </div>
                            </li>
                            <li class="param-item">
                                <div class="param-name">
                                    query_symptoms
                                    <span class="param-type">array[string]</span>
                                </div>
                                <div class="param-desc">
                                    อาการที่ระบบรู้จัก (อยู่ใน vocabulary)
                                </div>
                            </li>
                            <li class="param-item">
                                <div class="param-name">
                                    unknown_symptoms
                                    <span class="param-type">array[string]</span>
                                </div>
                                <div class="param-desc">
                                    อาการที่ระบบไม่รู้จัก (ไม่อยู่ใน vocabulary)
                                </div>
                            </li>
                        </ul>

                        <div class="tabs">
                            <button class="tab active" onclick="switchTab(event, 'req1')">Request</button>
                            <button class="tab" onclick="switchTab(event, 'res1')">Response</button>
                            <button class="tab" onclick="switchTab(event, 'curl1')">cURL</button>
                        </div>

                        <div id="req1" class="tab-content active">
                            <div class="code-block">
                                <pre><code>{
  <span class="string">"gender"</span>: <span class="string">"male"</span>,
  <span class="string">"age"</span>: <span class="number">26</span>,
  <span class="string">"symptoms"</span>: [<span class="string">"ไอ"</span>, <span class="string">"เสมหะ"</span>],
  <span class="string">"top_k"</span>: <span class="number">5</span>
}</code></pre>
                            </div>
                        </div>

                        <div id="res1" class="tab-content">
                            <div class="code-block">
                                <pre><code>{
  <span class="string">"recommendations"</span>: [
    <span class="string">"เจ็บคอ"</span>,
    <span class="string">"น้ำมูกไหล"</span>,
    <span class="string">"ไข้"</span>,
    <span class="string">"ปวดศีรษะ"</span>,
    <span class="string">"คัดจมูก"</span>
  ],
  <span class="string">"query_symptoms"</span>: [<span class="string">"ไอ"</span>, <span class="string">"เสมหะ"</span>],
  <span class="string">"unknown_symptoms"</span>: []
}</code></pre>
                            </div>
                        </div>

                        <div id="curl1" class="tab-content">
                            <div class="code-block">
                                <pre><code>curl -X POST http://localhost:8000/recommend \
  -H <span class="string">"Content-Type: application/json"</span> \
  -d <span class="string">'{
    "gender": "male",
    "age": 26,
    "symptoms": ["ไอ", "เสมหะ"],
    "top_k": 5
  }'</span></code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- GET /health -->
                <div class="endpoint" id="api-health">
                    <div class="endpoint-header">
                        <div>
                            <span class="endpoint-method method-get">GET</span>
                            <span class="endpoint-path">/health</span>
                        </div>
                        <p style="margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">
                            ตรวจสอบสถานะของ API server
                        </p>
                    </div>
                    <div class="endpoint-body">
                        <h4>Response</h4>
                        <div class="code-block">
                            <pre><code>{
  <span class="string">"status"</span>: <span class="string">"healthy"</span>,
  <span class="string">"model_loaded"</span>: <span class="keyword">true</span>,
  <span class="string">"device"</span>: <span class="string">"cpu"</span>,
  <span class="string">"vocabulary_size"</span>: <span class="number">338</span>
}</code></pre>
                        </div>
                    </div>
                </div>

                <!-- GET /symptoms -->
                <div class="endpoint" id="api-symptoms">
                    <div class="endpoint-header">
                        <div>
                            <span class="endpoint-method method-get">GET</span>
                            <span class="endpoint-path">/symptoms</span>
                        </div>
                        <p style="margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.875rem;">
                            ดูรายการอาการที่อยู่ใน vocabulary
                        </p>
                    </div>
                    <div class="endpoint-body">
                        <h4>Query Parameters</h4>
                        <ul class="param-list">
                            <li class="param-item">
                                <div class="param-name">
                                    limit
                                    <span class="param-type">integer</span>
                                    <span style="color: var(--text-secondary); font-size: 0.75rem;">optional</span>
                                </div>
                                <div class="param-desc">
                                    จำนวนอาการสูงสุดที่จะแสดง ค่าเริ่มต้น: <code>50</code>
                                </div>
                            </li>
                        </ul>

                        <h4>Response</h4>
                        <div class="code-block">
                            <pre><code>{
  <span class="string">"symptoms"</span>: [<span class="string">"ไอ"</span>, <span class="string">"เสมหะ"</span>, <span class="string">"เจ็บคอ"</span>, <span class="string">"..."</span>],
  <span class="string">"total"</span>: <span class="number">338</span>,
  <span class="string">"showing"</span>: <span class="number">50</span>
}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Error Handling -->
            <section id="error-handling" class="section">
                <h2>⚠️ Error Handling</h2>

                <div class="card">
                    <div class="card-title">400 Bad Request - Invalid Gender</div>
                    <div class="code-block">
                        <pre><code>{
  <span class="string">"detail"</span>: <span class="string">"Gender must be 'male' or 'female'"</span>
}</code></pre>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">400 Bad Request - Unknown Symptoms</div>
                    <div class="code-block">
                        <pre><code>{
  <span class="string">"detail"</span>: <span class="string">"None of the provided symptoms are in the vocabulary. Unknown: ['ท้องแสบ']"</span>
}</code></pre>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">500 Internal Server Error</div>
                    <div class="code-block">
                        <pre><code>{
  <span class="string">"detail"</span>: <span class="string">"Internal server error: ..."</span>
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Examples -->
            <section id="examples" class="section">
                <h2>📝 Use Cases & Examples</h2>

                <h3>Scenario 1: ผู้ป่วยชายอายุ 26 ปี มีอาการไอ</h3>
                <div class="card">
                    <div class="code-block">
                        <pre><code><span class="comment"># Request</span>
POST /recommend
{
  <span class="string">"gender"</span>: <span class="string">"male"</span>,
  <span class="string">"age"</span>: <span class="number">26</span>,
  <span class="string">"symptoms"</span>: [<span class="string">"ไอ"</span>]
}

<span class="comment"># Response</span>
{
  <span class="string">"recommendations"</span>: [<span class="string">"เสมหะ"</span>, <span class="string">"เจ็บคอ"</span>, <span class="string">"น้ำมูกไหล"</span>, <span class="string">"ไข้"</span>, <span class="string">"ปวดศีรษะ"</span>]
}</code></pre>
                    </div>
                </div>

                <h3>Scenario 2: ผู้ป่วยหญิงอายุ 35 ปี มีอาการปวดท้องและคลื่นไส้</h3>
                <div class="card">
                    <div class="code-block">
                        <pre><code><span class="comment"># Request</span>
POST /recommend
{
  <span class="string">"gender"</span>: <span class="string">"female"</span>,
  <span class="string">"age"</span>: <span class="number">35</span>,
  <span class="string">"symptoms"</span>: [<span class="string">"ปวดท้อง"</span>, <span class="string">"คลื่นไส้"</span>]
}

<span class="comment"># Response</span>
{
  <span class="string">"recommendations"</span>: [<span class="string">"อาเจียน"</span>, <span class="string">"ท้องเสีย"</span>, <span class="string">"จุกแน่นท้อง"</span>, <span class="string">"ไข้"</span>, <span class="string">"ปวดศีรษะ"</span>]
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- Footer -->
            <div style="margin-top: 4rem; padding-top: 2rem; border-top: 2px solid var(--border); color: var(--text-secondary); text-align: center;">
                <p>
                    <strong>Symptom Recommendation API v1.0</strong><br>
                    Powered by PyTorch, FastAPI, and PyTorch Geometric<br>
                    <span style="font-size: 0.875rem;">© 2024 All Rights Reserved</span>
                </p>
            </div>
        </main>
    </div>

    <script>
        // Smooth scroll
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });

                    // Update active state
                    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                }
            });
        });

        // Copy code
        function copyCode(btn) {
            const codeBlock = btn.closest('.code-block').querySelector('code');
            const text = codeBlock.textContent;

            navigator.clipboard.writeText(text).then(() => {
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            });
        }

        // Tab switching
        function switchTab(event, tabId) {
            const container = event.target.closest('.endpoint-body');
            const tabs = container.querySelectorAll('.tab');
            const contents = container.querySelectorAll('.tab-content');

            tabs.forEach(t => t.classList.remove('active'));
            contents.forEach(c => c.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // Auto-highlight current section
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.getAttribute('id');
                    document.querySelectorAll('.nav-item').forEach(item => {
                        if (item.getAttribute('href') === `#${id}`) {
                            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                            item.classList.add('active');
                        }
                    });
                }
            });
        }, { threshold: 0.5 });

        document.querySelectorAll('.section').forEach(section => {
            observer.observe(section);
        });
    </script>
</body>
</html>
